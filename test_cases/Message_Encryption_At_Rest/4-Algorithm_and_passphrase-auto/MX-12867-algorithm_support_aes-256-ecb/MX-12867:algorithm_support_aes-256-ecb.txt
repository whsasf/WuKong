1 set passphrase:

ram@bigchina ~/workspace/WuKong/test_cases/cassandra_test $ curl -s -X GET http://10.49.58.240:8081/mxos/encryption/v2/messageBodyEncryption|jq .
{
  "currentKey": {
    "uid": "1006",
    "cipherName": "aes-256-ecb",
    "encryptionKey": "66666666666666666666666666666666"
  },
  "keys": {
    "version": [
      {
        "uid": "1001",
        "cipherName": "aes-128-cbc",
        "encryptionKey": "6666666666666666"
      },
      {
        "uid": "1002",
        "cipherName": "aes-192-cbc",
        "encryptionKey": "666666666666666666666666"
      },
      {
        "uid": "1003",
        "cipherName": "aes-256-cbc",
        "encryptionKey": "66666666666666666666666666666666"
      },
      {
        "uid": "1004",
        "cipherName": "aes-128-ecb",
        "encryptionKey": "6666666666666666"
      },
      {
        "uid": "1005",
        "cipherName": "aes-192-ecb",
        "encryptionKey": "666666666666666666666666"
      },
      {
        "uid": "1006",
        "cipherName": "aes-256-ecb",
        "encryptionKey": "66666666666666666666666666666666"
      }
    ]
  }
}



2 restart mss, mta send message:

3 check cassandra:
 key     | 0xd571e8c072b211e88313fdd1c894d175
 column1 | 7
 value   | 0x31303036

@ Row 7
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 key     | 0xd571e8c072b211e88313fdd1c894d175
 column1 | 101
 value   | 0xeb2ff3a3100bb0850cedf81ce519e9cdcf46061cc377640cf3a137bd87c3ed9c7f37c48879a2e549cbc9912fc7fc5b67003d8be77c5e820aee9f6230849798e2fdedfd79c9a88540eb768a948ca5d3b818854246cf307e324ddf1a85bb616c6305a47f01fec8fe9d919a7dc43b0fbe166fc6ca11d691a5db24756cb07d8fc8b6060508282a60e48e7ee73e91aa1556d2cd870b69c92d8b0741a2fb9cd075e28d4a1cb524ebd6149121350c47d3b8848b28eb83c6c0d742a87333a050c93414ab00f3b34881e1741e55e6338ab58d427b1d60410271fb86599fbd8840265b83e6078aed790f737be8ff6bf1e85ab8910340f658f58f7f4ed80887b97476587336bcd7e5b8957cc3d663e8f55978140b681a80889ced631d9dbbbf66e30eaca7c4064832f5627168287d464d5538731329b8cc0ca8a9d83713e66eca5c92fce926d390668ba34276b98136e5baa3865f8393c31fe887db94c53c2aee7ceda79bc58983b8b26f7fdafccd7b8b9d253fd2c3f224842f1cebe2016233e09a7d615a67dd1cea4edcfb5ce27bc4e3ab7fbbf3907397cae1394c67ecfa7f63ae2078d716e207736643dc41b8dee80587b4f09d78301ea638ce7316671503f945764b465ffe52f6dd9ac2ea6025a5bdecf7c92864fafc01270e9adb9d46251d216ea88d5c59700229ecaa4a738e16e1dbe08e11c54ded8eb8e325381c450471db9d6eaab4b340afb427c8c6e8448c61bd62e48ea5515c7c743c6f27dff0e860a19ac467f7db8e2b6934f801ae61c9535c1430f4f359ccb5baf0979d1f1602f23ffc11e3428ff45912f66e75e6b372501498c39b7119975310cb1ba2b4f543c1a7e9afa0f43d6e891d02ca86433281436b49058e440d7518b49b6c7e3a8d8e42ad6313778f699797d6d84f1cfebc0e539a565515dc2a91de8f90a5e81b72c562e1032821950c5d6adc2a4eb6f125e24da3a544fd0e42ff6ee9cff6e110d2927c84ee027fb9520a524cfa149a311aff0feab6190777dcbebf511b2023b9e6c17020278e99518fa7eecfc3144446a78458afc92354ac4aa4bca0536fc9e119acbd6be394ad2991d1b9c1b6c775d699fa888c6b5731c71f777c6688257504562b5ce619bbb2376dce44278a19844cca7521b75f19cf3744ced9c327ecf64371d3fb356f851d7a0784fc5f288feb4aaeb97b40f9fea249aa45b07a3360bc17b75437686f3d25eb1715ce6fe160d35968e51189a7c104a0bfb240680ea3a0efaf3fd3d780b4d4f1f8d7162a6e0cf402d380276c540571b7024ed271f893040e2144d90cd4e8d1b87012ef344588268e00b4eb7623e3bf058360f63f3d7a1aa1da23df26ae0bb0f06f99bf37aa85298b5f6f14e4ac86674318a19f8ad310c9f55d58b6ff06707af6c52dcc9096055d143239b6c55531c3b5bed27b1a23ea0ab06f84b371a75643f0def3d12dbe9bac113bde79ae6590ab662fc610456b46412cd16dee90d224e8f980402ba4c6703f246c4b5416f998a26c96a77be6f2009ab202fc279e6e84265efdb30e7b39cd21145e67e69860a517e1272df65420d096d18c275c821874a23ee11d34861a64045996a831b1bed58bc5cb806fcd53fa5464f9bae296272c80284ae6648b07f0f904d95ac57a458da16a6451800fbc571daf3669e1e6422a2e3aa4530ab5d7599b12ac1f014fc5903ad1f059d021ed8cda3ce967757f9b055bec03eea0ff317f00c3a567e602ec9268bf0e8674fbf27a8bafb589d95da581354af2ae2ba407abad903ace87d3f9efe163f2cc95e6c0317cf9f16116d957fc9f50b98cca2ef9566e902f46f9f28f78b6b70b8dbe88209387c06a98e2a51d5d45d9f79bfebb7825b50872f7f8c79bc602cc544ef6cbb95267c0ed6f08d9a05b9cadfc4770e560f05be8a1def7c61d6f960fff235d21ee2b520eda0adbbcb17e87e3451737691b95e2cf72e2182d4aa565a048d766194e10ac489624f9ea3a779a9f0fbab41780e058eaca16122eba659815d1b9cb35159d963464b2d8a21cbc0e97614a3943941cdd16ee809622db5d39566e6d9c550788503f514bc74ba6e25b7017ce640eaad2b677118b4f701efaeb0ada93b35a3ca8238a2629e9e23e2fb82ed20cc65816ca50c77fb3d4505e2055d0f7806404330f57bcbc24cc89863e67c47517546efd3e14d9f17f367aad375fd1d898ca871f865579b89df19bbfb6c0f37cac6d750572b5bfbe60588f84067373a2799e4956318f1f2ab17227f629b2035c9f8a9fd0ff9a49a3a38b2d9fe3f90993cceedaeae0e8e887a974beeb0be780a7d6054a320726b82cb1ec149b7786e0b6d883ad692d96611d170c5e4a65b2a9a875af515ae9206d0713f7e0d28c3bf04ffbac7bc9f657ccc391d995feaf82a3cedb0841c5fa6a41c493a0e4d94af2f8d20cc65816ca50c77fb3d4505e2055d0db65df601fb9e01fa3d137b2dcd3ebb2943919b24bf260b6b4099320d329913ee98598675457b4b325390ddf13a5620ffa085963f7ca2c4b4bf77fd69a3961b18a6352c3889134e9ded5a484812eaa4f4622f85cf4bc3c72e5bb662c55c21cf996682f80eae42d1a06d29672616e96781b8b31fd6987a0b0060a869c72c6500939b72eb6bbd9e317e54912b8feda77a7

(7 rows)

4 decode data from cassandra manually:

....

5 IMAP fetch email:

a fetch 7 rfc822
* 7 FETCH (RFC822 {990}
Return-Path: <xx2@openwave.com>
Received: from [127.0.1.1] (really [10.37.2.214]) by mx1.openwave.com
          (InterMail vM.9.05.03.00 201-2473-138-1) with ESMTP
          id <20180618044824.ACP32511.mx1.openwave.com@[127.0.1.1]>
          for <xx1@openwave.com>; Mon, 18 Jun 2018 00:48:24 -0400
From: xx2
To: xx1
Subject: Sending Attachement
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary=AUNIQUEMARKER
Date: Mon, 18 Jun 2018 00:48:24 -0400
Message-Id: <20180618044824.ACP32511.mx1.openwave.com@[127.0.1.1]>

This is a multi-part message in MIME format.
--AUNIQUEMARKER
Content-Type: text/plain
Content-Transfer-Encoding:8bit

-This is a test email to send an attachement,haha,are you OK? we love world !!!!!!ucucucucucucucucucucucucucuc
--AUNIQUEMARKER
Content-Type: text/plain; name="attach.txt"
Content-Transfer-Encoding:base64
Content-Disposition: attachment; filename="attach.txt"

d29ybGQgcGVhY2UuYXJlIHUgT0s/aGFoYWhhaGFoYWhh
--AUNIQUEMARKER--
 FLAGS (\Recent \Seen))
a OK FETCH completed

2 messages the same.pass