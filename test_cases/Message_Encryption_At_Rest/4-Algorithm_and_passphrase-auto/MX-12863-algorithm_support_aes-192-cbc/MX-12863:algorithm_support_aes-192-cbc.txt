1 set passphrase:

ram@bigchina ~/workspace/WuKong/test_cases/cassandra_test $ curl -s -X POST  -d currentKey="1002:aes-192-cbc:666666666666666666666666" http://10.49.58.240:8081/mxos/encryption/v2/messageBodyEncryption|jq .
ram@bigchina ~/workspace/WuKong/test_cases/cassandra_test $ curl -s -X GET http://10.49.58.240:8081/mxos/encryption/v2/messageBodyEncryption|jq .
{
  "currentKey": {
    "uid": "1002",
    "cipherName": "aes-192-cbc",
    "encryptionKey": "666666666666666666666666"
  },
  "keys": {
    "version": [
      {
        "uid": "1001",
        "cipherName": "aes-128-cbc",
        "encryptionKey": "6666666666666666"
      },
      {
        "uid": "1002",
        "cipherName": "aes-192-cbc",
        "encryptionKey": "666666666666666666666666"
      }
    ]
  }
}



2 restart mss,mta send message:

3 check cassandra:
 
 key     | 0x7fe0a1a272ae11e895dbd27e30e786e6
 column1 | 7
 value   | 0x31303032

@ Row 7
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 key     | 0x7fe0a1a272ae11e895dbd27e30e786e6
 column1 | 101
 value   | 0x4f70bee441b945e70703b88fc078b28fa71ce80ee8254ba6cfe67304e7586fb38a94bb4282278e774176ac2f35167cd3fd87a6a6309352fd22b44a0d27bca27c1023819075cdeeaec474734f4d13118a9bfe4a8a82dfedf1d82fa1805122cf586755e063e5a9289807f37eb4adf364c7e785d4ead5d50edb4cbe502461780ecc21067fcd0adf0ce05bfafec4a07a0e74a6ed86cd2b6e039505505f64b51fb1f9bf98abc5fecb591ff3c099131e379e54eb375dac00bf35240f9cd873ff51dc9e2dd67878f1c0a4f0de9878bc5c56db5700d848e796a554247fcb669ac10696a46c6d81ce65973faaab4c0ea9041c3e2240fff1e9e3fe062206f7ab8affefc5011eeeb17f85e9a1c7ba595b5c09f69504924f04057b786e06dd682fed728a989a646c3e948344fd1f0ae1e98117bd0d76c9a599a4c1ec6b6ef6736d25e8fdd9c540f2bc12f39ac934cf1b588b0305a658ea6977c6b56cb33a425258b28f57b8d96fc82a389a9380749a35f3cd2431921021feadc3f4d8999453574897a5a6099796e74d3b23b1ae101719515e96cc8dc610552fdbaa8bcff0fb989cbf485f40bf5f323524623003e4c1204c0d40cac58287bc4848fcf8436a9b1d04f2ee194f561ad3d2d8d536a0fe73773c69396d1d264d25b15d014290f99b1d727e297d9b4b1edd3049a24ca5c6a350d67628aac3508d09d2f2feca1df96031996831cb36d374a220b599e318ec6796eba7d2fed3fc5d2822b80598dc2f476d40dd4b370c0730eee0d39775354054228b1b488ac93660ecf019be7aef3d229b5e5fc6623354a052a8f53d6a998866388df9e71138cc64e390a56702bce96d7709c14dd622e2d5f730a03f0522967155ca8fcb4bd7e72b0822526f5eb20563d5d7ed4c6dce01afba345ec330583f14f0c6830ad9096c9b39d5d1f9cb9edf306bdc8e7974b66683a5ba9b30c32db02f235763e357fd1f57940a200f9013982daa6562f8790c86674a2c7d21010d71f3738010604b838bf3c88daf51db526b95c1324ff2d4ae3285efa2f8196b7f0c91dd2fe33eb910df85d0a51ed0ecf22f15420aa793a98d0f459eea96df6c746e0207e64143efaf5b2233bc7c272df9639e76748689c5f6c4074a7daa538374fcf0823c7ff16a96ec8b66bb01cbe5c04853f8b455c80a3403b9135683253b9eca9586ef4dcacf30bd93bf93677472e9a2922de61102343c41e8155124fd659d09050ae0e216e805bba27d70ee0162852d521e1051156f7543f76123147f221f1ae5e72888f504920cf4544a5fe3a2a95c421b17023e086047e1835d83abba0554304c86cd771aef99ee1f67bd0c4c18f6cdb2f97829bfec859a42cd0dffbdde35e230826f42ddd35bc0da1ebffa39f088f4ef412bcb6cbcded2ef6c5ed5c36fb45920372b9f86d47e8b6e89837b9e239b7f357eb804fe28a92c6104a282ceed0ad36cadcb264a291297890df511e8fe7968d6fe757786f1dade21d73f18487b6aff36c38c7b6f3c017527d05b9963fcb64cf5d80754b590aac7a5fffbdc9b96b8770324869f4cd9e76772cedd1aef2222e9575e363a10e11ddcf3115bf2c03e08f2dce381347e8fe0a637976cc5f2f891a77ab09c6d06fa43b5763be6e580378d243c7a71abb6e65ebe935fc8a14e7f482a5affe1b0e9537ba787927af9486c3beb4e19e1f24ceaa0f73732031a19211085f57c7e59bcd9d60e47b50f153e10e71011d2f09613e20b557557647767d6c7e2dcdf54416f74c4073416a4489c123910333b79205ca08ac87687c810f3c67008a20a7a5d8eac18d0b41db8bd90747526858014c1061c57d79730e905855d65755363c65c71d1e0d4c5faef9a9c10bea26d8208db2a48c3c7493aedc5b3d9df81471fa9e07751a757edeff1fdc8841c75d1001793a9d8c0456fb0235e274c97f5489ab7964d69cbb08e6566144c8d3f002f066038788cfca62ec0e409679a8f4f6727599575080b7d967032ff1f58246182af13b183dfcfa815098438bdf8bf52b1ecd2b0713b5576623cc6c41c92fa3ab1eb84c1c43d1548517e5185a1e4445067a2af03a13fc91c44f601bb3fcc03eb683f6deae1bf597e5a5cda96a52454305b51de786204b8e2103c12ec87231e6af6b526e114915726011e626b9bb890ee2eb49182d801dd06e268f51056c44a57564d7a6bcb1ae9c584cf56660873879f85591af424ddbb0f4cbc019ed8fd282f7af79ad4890f1393332614000d3046ac9792a28eb3d1586dd59df92b72d89032f3e77fb687865da36288d1ed092d66ed04190aef2328b533f3410dc0e25a1ddc44fa96f8bd52f6938e98e90e8713b8f9582fee781da0647ffd9637bb7395854dcd2cff6e742c736d52c9dd6a54733f2560f8084cc9eea568d904e2785494abcc560f20d4f7f2b74885e4c2874efad7822f8456cc6bc67abb64649137132ac4b5fc45c74eb211b04415626f6171fe0e7733fb89f905fafae17890b37082564f417078d3a9fa79fbecce9b5b5115d375d3cead0794d9ed004e4754be2d0c88cfc5f17501db36bc9754a4f1cc2404d35ba2193bc1ad289c47f7edb4f42e41c1bec5a03075d6a355b8c9a19fdce0df8db40ed23eea17820856875c125a35c4928d3bd535e06d481c85

(7 rows)


4 decode data from cassandra manually:

...

5 IMAP fetch email:

Return-Path: <xx2@openwave.com>
Received: from [127.0.1.1] (really [10.37.2.214]) by mx1.openwave.com
          (InterMail vM.9.05.03.00 201-2473-138-1) with ESMTP
          id <20180618041722.ACL32511.mx1.openwave.com@[127.0.1.1]>
          for <xx1@openwave.com>; Mon, 18 Jun 2018 00:17:22 -0400
From: xx2
To: xx1
Subject: Sending Attachement
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary=AUNIQUEMARKER
Date: Mon, 18 Jun 2018 00:17:23 -0400
Message-Id: <20180618041722.ACL32511.mx1.openwave.com@[127.0.1.1]>

This is a multi-part message in MIME format.
--AUNIQUEMARKER
Content-Type: text/plain
Content-Transfer-Encoding:8bit

-This is a test email to send an attachement,haha,are you OK? we love world !!!!!!ucucucucucucucucucucucucucuc
--AUNIQUEMARKER
Content-Type: text/plain; name="attach.txt"
Content-Transfer-Encoding:base64
Content-Disposition: attachment; filename="attach.txt"

d29ybGQgcGVhY2UuYXJlIHUgT0s/aGFoYWhhaGFoYWhh
--AUNIQUEMARKER--


2 messages the same.pass