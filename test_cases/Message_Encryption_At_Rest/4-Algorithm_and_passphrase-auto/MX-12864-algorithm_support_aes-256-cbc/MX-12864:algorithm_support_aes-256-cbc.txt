1 set passphrase:

ram@bigchina ~/workspace/WuKong/test_cases/cassandra_test $ curl -s -X POST  -d currentKey="1003:aes-256-cbc:66666666666666666666666666666666" http://10.49.58.240:8081/mxos/encryption/v2/messageBodyEncryption|jq .
ram@bigchina ~/workspace/WuKong/test_cases/cassandra_test $ curl -s -X GET http://10.49.58.240:8081/mxos/encryption/v2/messageBodyEncryption|jq .
{
  "currentKey": {
    "uid": "1003",
    "cipherName": "aes-256-cbc",
    "encryptionKey": "66666666666666666666666666666666"
  },
  "keys": {
    "version": [
      {
        "uid": "1001",
        "cipherName": "aes-128-cbc",
        "encryptionKey": "6666666666666666"
      },
      {
        "uid": "1002",
        "cipherName": "aes-192-cbc",
        "encryptionKey": "666666666666666666666666"
      },
      {
        "uid": "1003",
        "cipherName": "aes-256-cbc",
        "encryptionKey": "66666666666666666666666666666666"
      }
    ]
  }
}


2 restart mss, mta send message:

3 check cassandra:

 key     | 0xe5f32a4072af11e881c1092cf03cddd3
 column1 | 7
 value   | 0x31303033

@ Row 7
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 key     | 0xe5f32a4072af11e881c1092cf03cddd3
 column1 | 101
 value   | 0x3b850358f707011e2b336a843e983dd05db6aebf811475f2982daf2d1831289510da70878ed2fc784173caf3508c52c11318c4f0a73fad8c376692e0b32b23992e9fad3fbc3fed40bf8067ae00c13c282d7e7d4a0538e0ff4bccc1361b706252fd7cda273ab1320439ee1661864e7e4ea9c1a6313f95466436e106c0e23934360146eb5364653879ea7b765414b342184531e29404c1f2384e33715a0772438ada0894abaeca0263299977f89c90448039012c7b3e30f28325e68a494afb69840fcb2c64780188941847826bfb83226c6f98567c27c552b8915f81a288f50e827f14ce9553a4a7927c661dea6c2457403bf4fb5ca113f33ff3c7ab65a1f374ce5661fde103842cf0e13e2b38f515c47a258b482503335f48cd5ea2b4f99e77e5fa379394b2d86080b9c5d91cc2d13ff1c2605756b6edb802d15cf413e8e34641690d188799b7f4ad8edda00b6854454d0c932ec7af51b904f87dfa15e1c7cfb228c1b387278fb584f3aeec11946a8bfbc745f048995f06d850a7b91c4186fbc24d3bccc9a33eaa2306c89287169912c2d9a29a1849d303bbd061eabc092d465187934766d427917479f16f8e6342a708d37d7a23a0906b9aaedba95390922764a010b17ef5f9a2023cd1266af9c8b8b0c0f424ed6dfd6ba7717e5e8c6000fe2a19d027701846f86317178cf06f1809f3232e429017331332ea8ce44e29bdb5fd7d9c079b55702631acc592fb4145ed62c305e3b80b904fe6a2ffa7bea22a4a2930ea9b1a8dd32b8b8559d71c336a208d344084d7613dc54547e9d99dc837e45064bcde371a9f3c416ddff29e001e161f83b93faca7486d304c34339e99fdd67030f86ac4283061b4af7de25e364b80de1617ce329af050130a93ab039a96ebc57e499e7cf2743d754c39b838e76ca04b435cc8b635b95cf07f076ea875ca2ca5a1a2c4f0e5838c014c9244cdf2d7a546aff90e625392060e81e7ccdf2695645eaf0a5d71cf488ae31c85d360af20ff0bb9cdceab677ceaca5e965a0e06b7c0afc4cb868f4c2f14fc0f74873e88af0a2c5c56252e03642c2b5a85f485feff3b3437cbb5c163fdd5e4a9edc0a38748cf021d43b66443daa43b18c0e68e08e63df7de0d8119d0a64389dd9fcde30b8a694ba33f25163d0fba70150d5f720528da26c656678bfa898ec8dc39eb4c49c05c89c2ba66464b107112f9d9781f73a48322118b5dfac66eff32ed06a77951598b3dab7ae46df432e064c8d8d5343858cd2e925fbb32e15f2778d69ac6b70bbf25c81f6c6913c61ad91640227af4e8d3b15b1ee77a5f2415753c59ef7eb73e25820d44f10c1110400da2385cb92cb8c092128519154b888dfc8d8dcdea08e27ff664ba8066c4b4cb5f44b8ec7ca27ef31db8f7c97827a49d7c7cf06eefd2666c3b752bc1e12706666b29462195b292662cae942a69f3e9448efbc4bd887bcf3bf35b3465f5e0c15b611916f1287c46fd936d59da9ca7bb4da8d89a19aa4c5b979e8ac1b634392258c31724597001eb72df16b56346aaf5878a888bf3c7d63b366a788d103c63fd15e407003acdd1f7cfab34e2cfa18a1f78e53c298e5911d3a1288b1cb0188153ba15eee1b0dd41f44571a1d587e108b3745935e57e2a0fecb5615b7992db6ebd1a3cc69d4ced6ff784fc4bfa4d4f63a354d665e97a059567cb62cf79997e262a59a1eaebced9dde8f0eadd65e7afe4a098ca5d4b8b3697dd3790374084bda9cbba0221c44031cafb2937e977c6f4b3c61dc917cc2e843177447c9686e5240602f1147c233ebfba11c5315536d685cea595ede6ff838ed1b214cef3b46cbeee93d03ae7d8f1c3b04cb54340a8cffe3dc6a293033fa2e4e37e52defb13c50a0f1b4f8b0ea87def5a3beca5b0e48c2ac4e065e9b173c9fcb357ccd8bee979abd72bf3138f83db38d74d64f812e9904997d5bdcc108a26b0f9bbeb7e7cd8993ea1aab87a4b3757c8ae1fcd3af4f954efbe2207e48f5550bbf7c16b38ae18827b792c85a8ca5480d73b79b24aa42cd7205a5f861f105d1ffece829d23981959268c48287a5a675592ca38b5bb60ee8f2766747307fcbe677b1bbcddfe4ba274ea068ef458f23072013411105bd6e4bccf9a4eebaf6694e14336a40b53677249ccb309b1a5bc9713792a6ae53fc389d45869faaf24432729a09e9c2d13c6c5723b795972f3fa57ea566521cf025e531602cd03d57af3e5864af946a5fc4c58095caee1e47d9b25b2a94e4da3dec9787dc1a7c255dee65bc8327e6ded9aa6e85f03ebc071eb17aa0072baf299fc200163a5db51c83f0c13d0dcfb4de9dcfd6939cb09ebb3b83fb5bff51558eec486a1840570f11f27c0d2fc696fd367c8fb2dab3808dbc2d90a13ba3b5495d42d045d031a57242d7273cb8af96a00f5a0be74fcf7fd4f6b3fa7383ad19ccba371085215eb6e448154473eef0b4c2af8a5b676a2dfe192f4e4778241bc1969a69427b6e980fb07e83b719f1862c9d1f5db7a6bec6428a281b2a259ac8d094cf3ce7b389a61ad8429b303fc5a5063b7f528026189fb0897ed92371ea857340082d49038712b377e1a6ae34d9f23a2c10091d0832b6f13b91d081bfb648ed7d6e20668667911ae2829dcb6d6f17eedd247ed51

(7 rows)

4 decode data from cassandra manually:

....

5 IMAP fetch email:

Return-Path: <xx2@openwave.com>
Received: from [127.0.1.1] (really [10.37.2.214]) by mx1.openwave.com
          (InterMail vM.9.05.03.00 201-2473-138-1) with ESMTP
          id <20180618042723.ACM32511.mx1.openwave.com@[127.0.1.1]>
          for <xx1@openwave.com>; Mon, 18 Jun 2018 00:27:23 -0400
From: xx2
To: xx1
Subject: Sending Attachement
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary=AUNIQUEMARKER
Date: Mon, 18 Jun 2018 00:27:23 -0400
Message-Id: <20180618042723.ACM32511.mx1.openwave.com@[127.0.1.1]>

This is a multi-part message in MIME format.
--AUNIQUEMARKER
Content-Type: text/plain
Content-Transfer-Encoding:8bit

-This is a test email to send an attachement,haha,are you OK? we love world !!!!!!ucucucucucucucucucucucucucuc
--AUNIQUEMARKER
Content-Type: text/plain; name="attach.txt"
Content-Transfer-Encoding:base64
Content-Disposition: attachment; filename="attach.txt"

d29ybGQgcGVhY2UuYXJlIHUgT0s/aGFoYWhhaGFoYWhh
--AUNIQUEMARKER--
 FLAGS (\Seen))


2 messages the same.pass