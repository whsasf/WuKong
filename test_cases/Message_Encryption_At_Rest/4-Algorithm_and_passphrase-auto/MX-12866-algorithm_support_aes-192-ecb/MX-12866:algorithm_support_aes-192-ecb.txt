1 set passphrase:

ram@bigchina ~/workspace/WuKong/test_cases/cassandra_test $ curl -s -X POST  -d currentKey="1005:aes-192-ecb:666666666666666666666666" http://10.49.58.240:8081/mxos/encryption/v2/messageBodyEncryption|jq .
ram@bigchina ~/workspace/WuKong/test_cases/cassandra_test $ curl -s -X GET http://10.49.58.240:8081/mxos/encryption/v2/messageBodyEncryption|jq .
{
  "currentKey": {
    "uid": "1005",
    "cipherName": "aes-192-ecb",
    "encryptionKey": "666666666666666666666666"
  },
  "keys": {
    "version": [
      {
        "uid": "1001",
        "cipherName": "aes-128-cbc",
        "encryptionKey": "6666666666666666"
      },
      {
        "uid": "1002",
        "cipherName": "aes-192-cbc",
        "encryptionKey": "666666666666666666666666"
      },
      {
        "uid": "1003",
        "cipherName": "aes-256-cbc",
        "encryptionKey": "66666666666666666666666666666666"
      },
      {
        "uid": "1004",
        "cipherName": "aes-128-ecb",
        "encryptionKey": "6666666666666666"
      },
      {
        "uid": "1005",
        "cipherName": "aes-192-ecb",
        "encryptionKey": "666666666666666666666666"
      }
    ]
  }
}




2 restart mss,mta send message:

3 check cassandra:
 key     | 0x18ff392c72b211e8b72f3cdacd2459d6
 column1 | 7
 value   | 0x31303035

@ Row 7
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 key     | 0x18ff392c72b211e8b72f3cdacd2459d6
 column1 | 101
 value   | 0x31e4b03d17f319361df40e28b1397d55e519811ec0a15831ef84d14b367384eba128d298a0589348e0690f8e4a8c10599f535ddafd818d5ac4b866467d0c4d0785e326f16818b9e4b32af07bf2769431f305328bd3837824ecb67b229b772695653359f521e85a674fb8e69af1042aabb9fe6a7a2f4f7ec83be6aed9ea4cd4913d49259baccb437277718f44e6e81923c6bdfc26d78c740406f9a12672d35accff08ac56e04f05a77c89ce5a2bca483c320f722868c1f04a5a28a95ec9a0dd89d1ddfa6b1e50e4c42c1463e68547fe6691a7a3c8216af0ac5a4dc8cfdf43fbfa143c8edea6ea63cfcdc48860cf88256ba6ce478dab685bdd4687e26a4e0896ce8dfbe6cf45d0b7757164dc92f2eff51117ff7c415b0e8c16fa5452cb73f9e5f74c3be6da91f6893f19ea2ea7bea3692abb59e9f3736e685f920d96d595f0c0df4177fb3261905f5dcfd3c0cbcdda4eb6e9acfa384763bd3b44d241394b90a4312c2fe285b7ac588932a5e3bcb57fba64c61a3b92607c714987772bcbab130b66398f2feece2b1013586e49dbb315aa88575eba762d6a02cbd6a896ab2b9c0db4deb8eb5193159ab9ea3dbaa5a7c71027a613ddc0513983f73b1ce017b37d6deb577315ef8c9dd85744282cc4ec8abc4511a70dd1a8de6017d55a8ffa30534319cce5dc7910b8e301cb646d9f91a04a3984583097a46a89f4bb51da50682dd9e99051ea91b8765f388f3de13339c94a2a8b0c0410c4055b38d596f912fc4bb6ca70aee71cede9d803e1d72fedd2a608c89e1e346376c96cf6d4e3cae5c4b7b9ceb752fa10dda6dcd5b88863ced1775774de47150894298c52abf2f6e8d3526ae03aeab3d56fbb5efae6026ff625ad3b624a9a56d4b840bd316f5bb2dc275eff19d69a65f5b5bdb443b76211382d0f5bb4db009c6d9c2dc9c1137e5e5e8d7fa11786a7839d7fca8505f284f77ee9b494e2e30c63c9d3016a50ee70ca167a7a7259ec2af0959b6cef5f659cda368e5c50dc7470d737d8ef36f7226c641c0a68d09e906dc6d6bbdb6db2d26af532e7dfa16c54b1e4e64193815d241a406b9ae228939f6430ee6298c906e6cb003c66e4cc7e4cc7368335f988f5b9250cb6baea73facd07d78e918d2f5ce932dee195aaa97a6f6d710e4fd42044c4ed58184c613cdfaf541f353846f426ef346616fd33be59d69e6aee29360ba34f15ce26834f96312d6c8343535ce4691d0c60c380f0e8361b5c430827800a72f41cea705076cb2e7e4865bc41033fb191ef3e8102e317440129f4f1f5ed3688ea35cae5131ac1c007fbce014d2439c03a254a1c3351f7b85e7f22502dece6bc9e150fc52349856758f65f702811610e897605bdf473da5f2376ca37aee1f3fdd7732ef2070e1ffffdae83d7ef3b7713f5ffabe145caa6b916c61aae1abf3f719275abf879b5a7a3bebaac25db7a88be1af18c875f49ac59081add1f7f81ca5c72580fa63e5d87398c7e557772ea4120d604fbf9e191bdbff94e45522696e9e4899fb95ab277d0e500a336a6124ea0430a0dacc4ee5ad5b9e33a85cf45d1b452c651db47513ebd9b60385af07720317d29c360f2648fd50eece5c5e73470dcbddf05cc4ec5a4eab1ef2d55227a563b3eddb478a2cb09d65d4870132b6b5e3a7c7000e89c5ff6b2e4a3c4e5aa820df45790dca457352c273321d9ebafe378cf2b4fdfa82dedfdc0c6665ec6275eaa10ea4f63eb9e88a311f2f63fa4e0b44d49996fbdbf1664ae62b9eb883abf777d39dab30b3dbb0637ebb3cdec0bfc1f455466bc05e9adc95116d7857c21a5ce49d528effa8d86b9e5d70ccd3c58c0af55720f508a9d537d2de17765e7c3fb20b4ca3cbb6845670e6d2d34faec99a2291ad8f89ea94a4ad6f546c93d65715ad066916a3c6dfb49eddbd3c6c498ac9baa85a5582b2f5deda4af4deb82db977fa76ce9688abfabec1afa16302c70b52acca48ef43400b3e0fae2c1467fa89ebe8ef18af34f21183b0f36d632a7024dbaade5614e5a8c4f73e0e092a66d7af0469940b943d679f45bce16df74e536093e3e561c7bb9c3a9d611d793977c2e98eab399b0cec3ef87ce3080ec101c61eab127a881965fd598e88d1fb77eb6bedfe865c169b295e91339331567d4990f08822c3eb593459950eb4bc923d4f01ab4638418b27b05acc427befb510fa494a33b6e00c227791b18120421f19af027939bb38018827e890d8bc42b6dfe1c4463fa03c12bd4043c5f5f7edc3cf9aec60bd353451565c4bf8cc604e8d6c7ea2c8ad7cdd3f4501be32491a1746815fe5a1b7e4a4ada24f2794a806f9d8f79308dfdb3469aa777e7c07b71d8cffd87861500e076fc99dd7b05eeb3395d5e6c4873bb8f805186d690edf91535546d27eabc1823472bc60fae183ac79699aea4b6bedfe865c169b295e91339331567d48152943c043e9ac1cf5c213c36c4e32a9931b660e6eafb47373c2bf57c92eb3048bc7f9decd5ef6e54dddeb191f40cb63ddd452d20fe4e98fe800fc7ae20490819fba6b542732aa476f3b296bfa0a7de93e371c729fc9f5f4e11ebcbed6e9351c1c10a96bfe3964375bbf5c88d235879eb33685003b70d819797fdf2b0831a3ddf65283df2373d425cffe2fedb4c4ad1

(7 rows)


4 decode data from cassandra manually:

...

5 IMAP fetch email:

a fetch 6 rfc822
* 6 FETCH (RFC822 {990}
Return-Path: <xx2@openwave.com>
Received: from [127.0.1.1] (really [10.37.2.214]) by mx1.openwave.com
          (InterMail vM.9.05.03.00 201-2473-138-1) with ESMTP
          id <20180618044308.ACO32511.mx1.openwave.com@[127.0.1.1]>
          for <xx1@openwave.com>; Mon, 18 Jun 2018 00:43:08 -0400
From: xx2
To: xx1
Subject: Sending Attachement
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary=AUNIQUEMARKER
Date: Mon, 18 Jun 2018 00:43:08 -0400
Message-Id: <20180618044308.ACO32511.mx1.openwave.com@[127.0.1.1]>

This is a multi-part message in MIME format.
--AUNIQUEMARKER
Content-Type: text/plain
Content-Transfer-Encoding:8bit

-This is a test email to send an attachement,haha,are you OK? we love world !!!!!!ucucucucucucucucucucucucucuc
--AUNIQUEMARKER
Content-Type: text/plain; name="attach.txt"
Content-Transfer-Encoding:base64
Content-Disposition: attachment; filename="attach.txt"

d29ybGQgcGVhY2UuYXJlIHUgT0s/aGFoYWhhaGFoYWhh
--AUNIQUEMARKER--
 FLAGS (\Seen))
a OK FETCH completed



2 messages the same.pass